name: Verify Codex Agent Scripts

on:
  push:
    branches: [ main, master ]
  pull_request:

jobs:
  verify:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/openai/codex-universal:latest
      env:
        CODEX_ENV_RUST_VERSION: 1.87.0
        CODEX_ENV_PYTHON_VERSION: 3.12
        CODEX_ENV_GO_VERSION: 1.24.3
        CODEX_ENV_NODE_VERSION: 22
    steps:
      - name: Check out repository
        uses: actions/checkout@v4
      - name: Run codex setup
        run: HOME=/root /opt/codex/setup_universal.sh
      - name: Run setup
        run: .agent/setup.sh
      - name: Run checks
        run: .agent/check.sh
